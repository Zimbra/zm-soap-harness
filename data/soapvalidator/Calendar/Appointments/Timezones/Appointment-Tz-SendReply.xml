<t:tests xmlns:t="urn:zimbraTestHarness">
<t:property name="server.zimbraAdmin" value="${zimbraServer.name}"/>

<t:property name="test_account1.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>
<t:property name="invitee_account1.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>
<t:property name="appointment.subject" value="Subject of meeting${TIME}.${COUNTER}"/>
<t:property name="appointment.location" value="Location of meeting${TIME}.${COUNTER}"/>
<t:property name="appointment.content" value="Content of the message${TIME}.${COUNTER}"/>
<t:property name="test_acct.server" value="NOT_DEFINED"/>
<t:property name="invitee_acct.server" value="NOT_DEFINED"/>
<t:property name="calendar.verb1" value="ACCEPT"/>
<t:property name="calendar.verb2" value="DECLINE"/>
<t:property name="calendar.verb3" value="TENTATIVE"/>

<t:property name="TZ1" value="(GMT-12.00) International Date Line West"/>
<t:property name="TZ1New" value="Etc/GMT+12"/>
<t:property name="TZ2" value="(GMT-11.00) Midway Island / Samoa"/>
<t:property name="TZ2New" value="Pacific/Midway"/>
<t:property name="TZ3" value="(GMT-10.00) Hawaii"/>
<t:property name="TZ3New" value="Pacific/Honolulu"/>
<t:property name="TZ4" value="(GMT-09.00) Alaska"/>
<t:property name="TZ4New" value="America/Anchorage"/>
<t:property name="TZ5" value="(GMT-08.00) Pacific Time (US &amp; Canada) / Tijuana"/>
<t:property name="TZ5New" value="America/Los_Angeles"/>
<t:property name="TZ6" value="(GMT-07.00) Arizona"/>
<t:property name="TZ6New" value="America/Phoenix"/>
<t:property name="TZ7" value="(GMT-07.00) Chihuahua / La Paz / Mazatlan"/>
<t:property name="TZ7New" value="America/Chihuahua"/>
<t:property name="TZ8" value="(GMT-07.00) Mountain Time (US &amp; Canada)"/>
<t:property name="TZ8New" value="America/Denver"/>
<t:property name="TZ9" value="(GMT-06.00) Central America"/>
<t:property name="TZ9New" value="America/Guatemala"/>
<t:property name="TZ10" value="(GMT-06.00) Central Time (US &amp; Canada)"/>
<t:property name="TZ10New" value="America/Chicago"/>
<t:property name="TZ11" value="(GMT-06.00) Guadalajara / Mexico City / Monterrey"/>
<t:property name="TZ11New" value="America/Mexico_City"/>
<t:property name="TZ12" value="(GMT-06.00) Saskatchewan"/>
<t:property name="TZ12New" value="America/Regina"/>
<t:property name="TZ13" value="(GMT-05.00) Bogota / Lima / Quito"/>
<t:property name="TZ13New" value="America/Bogota"/>
<t:property name="TZ14" value="(GMT-05.00) Eastern Time (US &amp; Canada)"/>
<t:property name="TZ14New" value="America/New_York"/>
<t:property name="TZ15" value="(GMT-05.00) Indiana (East)"/>
<t:property name="TZ15New" value="America/Indiana/Indianapolis"/>
<t:property name="TZ16" value="(GMT-04.00) Atlantic Time (Canada)"/>
<t:property name="TZ16New" value="America/Halifax"/>
<t:property name="TZ17" value="(GMT-04.00) Caracas / La Paz"/>
<t:property name="TZ17New" value="America/La_Paz"/>
<t:property name="TZ18" value="(GMT-04.00) Santiago"/>
<t:property name="TZ18New" value="America/Santiago"/>
<t:property name="TZ19" value="(GMT-03.30) Newfoundland"/>
<t:property name="TZ19New" value="America/St_Johns"/>
<t:property name="TZ20" value="(GMT-03.00) Brasilia"/>
<t:property name="TZ20New" value="America/Sao_Paulo"/>
<t:property name="TZ21" value="(GMT-03.00) Buenos Aires / Georgetown"/>
<t:property name="TZ21New" value="America/Argentina/Buenos_Aires"/>
<t:property name="TZ22" value="(GMT-03.00) Greenland"/>
<t:property name="TZ22New" value="America/Godthab"/>
<t:property name="TZ23" value="(GMT-02.00) Mid-Atlantic"/>
<t:property name="TZ23New" value="Atlantic/South_Georgia"/>
<t:property name="TZ24" value="(GMT-01.00) Azores"/>
<t:property name="TZ24New" value="Atlantic/Azores"/>
<t:property name="TZ25" value="(GMT-01.00) Cape Verde Is."/>
<t:property name="TZ25New" value="Atlantic/Cape_Verde"/>
<t:property name="TZ26" value="(GMT) Casablanca / Monrovia"/>
<t:property name="TZ26New" value="Africa/Monrovia"/>
<t:property name="TZ27" value="(GMT) Greenwich Mean Time - Dublin / Edinburgh / Lisbon / London"/>
<t:property name="TZ27New" value="Europe/London"/>
<t:property name="TZ28" value="(GMT+01.00) Amsterdam / Berlin / Bern / Rome / Stockholm / Vienna"/>
<t:property name="TZ28New" value="Europe/Berlin"/>
<t:property name="TZ29" value="(GMT+01.00) Belgrade / Bratislava / Budapest / Ljubljana / Prague"/>
<t:property name="TZ29New" value="Europe/Belgrade"/>
<t:property name="TZ30" value="(GMT+01.00) Brussels / Copenhagen / Madrid / Paris"/>
<t:property name="TZ30New" value="Europe/Brussels"/>
<t:property name="TZ31" value="(GMT+01.00) Sarajevo / Skopje / Warsaw / Zagreb"/>
<t:property name="TZ31New" value="Europe/Warsaw"/>
<t:property name="TZ32" value="(GMT+01.00) West Central Africa"/>
<t:property name="TZ32New" value="Africa/Algiers"/>
<t:property name="TZ33" value="(GMT+02.00) Athens / Beirut / Istanbul / Minsk"/>
<t:property name="TZ33New" value="Europe/Athens"/>
<t:property name="TZ34" value="(GMT+02.00) Bucharest"/>
<t:property name="TZ34New" value="Europe/Bucharest"/>
<t:property name="TZ35" value="(GMT+02.00) Cairo"/>
<t:property name="TZ35New" value="Africa/Cairo"/>
<t:property name="TZ36" value="(GMT+02.00) Harare / Pretoria"/>
<t:property name="TZ36New" value="Africa/Harare"/>
<t:property name="TZ37" value="(GMT+02.00) Helsinki / Kyiv / Riga / Sofia / Tallinn / Vilnius"/>
<t:property name="TZ37New" value="Europe/Helsinki"/>
<t:property name="TZ38" value="(GMT+02.00) Jerusalem"/>
<t:property name="TZ38New" value="Asia/Jerusalem"/>
<t:property name="TZ39" value="(GMT+03.00) Baghdad"/>
<t:property name="TZ39New" value="Asia/Baghdad"/>
<t:property name="TZ40" value="(GMT+03.00) Kuwait / Riyadh"/>
<t:property name="TZ40New" value="Asia/Kuwait"/>
<t:property name="TZ41" value="(GMT+03.00) Moscow / St. Petersburg / Volgograd"/>
<t:property name="TZ41New" value="Europe/Moscow"/>
<t:property name="TZ42" value="(GMT+03.00) Nairobi"/>
<t:property name="TZ42New" value="Africa/Nairobi"/>
<t:property name="TZ43" value="(GMT+03.30) Tehran"/>
<t:property name="TZ43New" value="Asia/Tehran"/>
<t:property name="TZ44" value="(GMT+04.00) Abu Dhabi / Muscat"/>
<t:property name="TZ44New" value="Asia/Muscat"/>
<t:property name="TZ45" value="(GMT+04.00) Baku / Tbilisi / Yerevan"/>
<t:property name="TZ45New" value="Asia/Baku"/>
<t:property name="TZ46" value="(GMT+04.30) Kabul"/>
<t:property name="TZ46New" value="Asia/Kabul"/>
<t:property name="TZ47" value="(GMT+05.00) Ekaterinburg"/>
<t:property name="TZ47New" value="Asia/Yekaterinburg"/>
<t:property name="TZ48Karachi" value="Asia/Karachi"/>
<t:property name="TZ48Tashkent" value="Asia/Tashkent"/>
<t:property name="TZ49" value="(GMT+05.30) Chennai / Kolkata / Mumbai / New Delhi"/>
<t:property name="TZ49New" value="Asia/Kolkata"/>
<t:property name="TZ50" value="(GMT+05.45) Kathmandu"/>
<t:property name="TZ50New" value="Asia/Kathmandu"/>
<t:property name="TZ51" value="(GMT+06.00) Almaty / Novosibirsk"/>
<t:property name="TZ51New" value="Asia/Novosibirsk"/>
<t:property name="TZ52" value="(GMT+06.00) Astana / Dhaka"/>
<t:property name="TZ52New" value="Asia/Dhaka"/>
<t:property name="TZ53" value="(GMT+06.00) Sri Jayawardenepura"/>
<t:property name="TZ53New" value="Asia/Colombo"/>
<t:property name="TZ54" value="(GMT+06.30) Rangoon"/>
<t:property name="TZ54New" value="Asia/Rangoon"/>
<t:property name="TZ55" value="(GMT+07.00) Bangkok / Hanoi / Jakarta"/>
<t:property name="TZ55New" value="Asia/Bangkok"/>
<t:property name="TZ56" value="(GMT+07.00) Krasnoyarsk"/>
<t:property name="TZ56New" value="Asia/Krasnoyarsk"/>
<t:property name="TZ57" value="(GMT+08.00) Beijing / Chongqing / Hong Kong / Urumqi"/>
<t:property name="TZ57New" value="Asia/Hong_Kong"/>
<t:property name="TZ58" value="(GMT+08.00) Irkutsk / Ulaan Bataar"/>
<t:property name="TZ58New" value="Asia/Irkutsk"/>
<t:property name="TZ59" value="(GMT+08.00) Kuala Lumpur / Singapore"/>
<t:property name="TZ59New" value="Asia/Singapore"/>
<t:property name="TZ60" value="(GMT+08.00) Perth"/>
<t:property name="TZ60New" value="Australia/Perth"/>
<t:property name="TZ61" value="(GMT+08.00) Taipei"/>
<t:property name="TZ61New" value="Asia/Taipei"/>
<t:property name="TZ62" value="(GMT+09.00) Osaka / Sapporo / Tokyo"/>
<t:property name="TZ62New" value="Asia/Tokyo"/>
<t:property name="TZ63" value="(GMT+09.00) Seoul"/>
<t:property name="TZ63New" value="Asia/Seoul"/>
<t:property name="TZ64" value="(GMT+09.00) Yakutsk"/>
<t:property name="TZ64New" value="Asia/Yakutsk"/>
<t:property name="TZ65" value="(GMT+09.30) Adelaide"/>
<t:property name="TZ65New" value="Australia/Adelaide"/>
<t:property name="TZ66" value="(GMT+09.30) Darwin"/>
<t:property name="TZ66New" value="Australia/Darwin"/>
<t:property name="TZ67" value="(GMT+10.00) Brisbane"/>
<t:property name="TZ67New" value="Australia/Brisbane"/>
<t:property name="TZ68" value="(GMT+10.00) Canberra / Melbourne / Sydney"/>
<t:property name="TZ68New" value="Australia/Sydney"/>
<t:property name="TZ69" value="(GMT+10.00) Guam / Port Moresby"/>
<t:property name="TZ69New" value="Pacific/Guam"/>
<t:property name="TZ70" value="(GMT+10.00) Hobart"/>
<t:property name="TZ70New" value="Australia/Hobart"/>
<t:property name="TZ71" value="(GMT+10.00) Vladivostok"/>
<t:property name="TZ71New" value="Asia/Vladivostok"/>
<t:property name="TZ72" value="(GMT+11.00) Magadan / Solomon Is. / New Caledonia"/>
<t:property name="TZ72New" value="Asia/Magadan"/>
<t:property name="TZ73" value="(GMT+12.00) Auckland / Wellington"/>
<t:property name="TZ73New" value="Pacific/Auckland"/>
<t:property name="TZ74" value="(GMT+12.00) Fiji / Kamchatka / Marshall Is."/>
<t:property name="TZ74New" value="Pacific/Fiji"/>
<t:property name="TZ75" value="(GMT+13.00) Nuku'alofa"/>
<t:property name="TZ75New" value="Pacific/Tongatapu"/>


<t:test_case testcaseid="Ping" type="always" >
    <t:objective>basic system check</t:objective>
    
    <t:test id="ping" required="true">
        <t:request>
            <PingRequest xmlns="urn:zimbraAdmin"/>
        </t:request>
        <t:response>
            <t:select path="//admin:PingResponse"/>
        </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="AcctSetup_ApptTZ01" type="always" >
    <t:objective>Create test accounts</t:objective>
   
    <t:test id="admin_login" required="true" depends="ping">
        <t:request>
            <AuthRequest xmlns="urn:zimbraAdmin">
                <name>${admin.user}</name>
                <password>${admin.password}</password>
            </AuthRequest>
        </t:request>
        <t:response>
            <t:select path="//admin:AuthResponse/admin:authToken" set="authToken"/>
        </t:response>
    </t:test>
    
    <t:test id="create_test_account1" required="true" depends="admin_login">
        <t:request>
            <CreateAccountRequest xmlns="urn:zimbraAdmin">
                <name>${test_account1.name}</name>
                <password>${defaultpassword.value}</password>
            </CreateAccountRequest>
        </t:request>
        <t:response>
            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id" set="test_account1.id"/>
            <t:select path='//admin:CreateAccountResponse/admin:account/admin:a[@n="zimbraMailHost"]' set="test_acct.server"/>
        </t:response>
    </t:test>
    
	<t:test id="create_invitee_account1" required="true" depends="admin_login">
        <t:request>
            <CreateAccountRequest xmlns="urn:zimbraAdmin">
                <name>${invitee_account1.name}</name>
                <password>${defaultpassword.value}</password>
            </CreateAccountRequest>
        </t:request>
        <t:response>
            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id" set="invitee_account1.id"/>
            <t:select path='//admin:CreateAccountResponse/admin:account/admin:a[@n="zimbraMailHost"]' set="invitee_acct.server"/>
        </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="AcctSetup_ApptTZ02" type="always" >
    <t:objective>login as the test account</t:objective>

<t:property name="server.zimbraAccount" value="${test_acct.server}"/>
    
    <t:test id="auth1" required="true">
        <t:request>
            <AuthRequest xmlns="urn:zimbraAccount">
                <account by="name">${test_account1.name}</account>
                <password>${defaultpassword.value}</password>
            </AuthRequest>
        </t:request>
        <t:response>
            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>

        </t:response>
    </t:test>
    
	<t:test required="true">
        <t:requestContext>
            <authToken>${authToken}</authToken>
            <session/>
        </t:requestContext>
        <t:request>
            <NoOpRequest xmlns="urn:zimbraMail"/>
        </t:request>
        <t:response>
            <t:select path="//mail:NoOpResponse"/>
        </t:response>
    </t:test>

    <t:property name="test1.authToken" value="${authToken}"/>  


	<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:test id="auth2" required="true">
        <t:request>
            <AuthRequest xmlns="urn:zimbraAccount">
                <account by="name">${invitee_account1.name}</account>
                <password>${defaultpassword.value}</password>
            </AuthRequest>
        </t:request>
        <t:response>
            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>

        </t:response>
    </t:test>

    <t:property name="invitee1.authToken" value="${authToken}"/>  

	<t:test required="true">
        <t:requestContext>
            <authToken>${authToken}</authToken>
            <session/>
        </t:requestContext>
        <t:request>
            <NoOpRequest xmlns="urn:zimbraMail"/>
        </t:request>
        <t:response>
            <t:select path="//mail:NoOpResponse"/>
        </t:response>
    </t:test>


</t:test_case>

<t:test_case testcaseid="CreateAppt_TZ1" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ1 included and accept that appointment (as invitee).</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ1}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ1}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ1}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ1}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment1.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ1New}']" attr="d" set="start1.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ1New}']" attr="d" set="end1.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment1.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start1.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end1.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ1})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt1.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt1.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ1}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ2" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ2 included and (as invitee) decline that appointment.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ2}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ2}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ2}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ2}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment2.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ2New}']" attr="d" set="start2.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ2New}']" attr="d" set="end2.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment2.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start2.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end2.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ2})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt2.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt2.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ2}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ3" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ3 included (as invitee) mark that appointment tentative.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ3}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ3}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ3}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ3}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment3.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ3New}']" attr="d" set="start3.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ3New}']" attr="d" set="end3.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment3.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start3.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end3.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ3})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt3.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt3.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ3}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ4" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ4 included (as invitee) accept that appointment.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ4}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ4}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ4}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ4}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment4.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ4New}']" attr="d" set="start4.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ4New}']" attr="d" set="end4.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment4.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start4.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end4.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ4})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt4.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt4.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ4}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ5" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ5 included and (as invitee) decline that appointment..</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ5}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ5}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ5}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ5}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment5.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ5New}']" attr="d" set="start5.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ5New}']" attr="d" set="end5.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment5.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start5.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end5.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ5})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt5.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt5.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ5}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ6" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ6 included and (as invitee) mark that appointment tentative.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ6}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ6}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ6}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ6}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment6.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ6New}']" attr="d" set="start6.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ6New}']" attr="d" set="end6.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment6.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start6.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end6.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ6})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt6.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt6.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ6}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ7" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ7 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ7}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ7}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ7}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ7}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment7.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ7New}']" attr="d" set="start7.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ7New}']" attr="d" set="end7.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment7.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start7.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end7.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ7})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt7.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt7.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ7}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ8" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ8 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ8}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ8}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ8}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ8}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment8.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ8New}']" attr="d" set="start8.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ8New}']" attr="d" set="end8.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment8.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start8.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end8.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ8})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt8.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt8.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ8}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ9" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ9 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ9}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ9}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ9}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ9}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment9.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ9New}']" attr="d" set="start9.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ9New}']" attr="d" set="end9.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment9.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start9.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end9.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ9})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt9.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt9.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ9}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ10" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ10 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ10}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+30m)}" tz="${TZ10}"/>  
                        <e d="${ICALTIME(+1h)}" tz="${TZ10}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ10}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment10.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ10New}']" attr="d" set="start10.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ10New}']" attr="d" set="end10.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment10.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start10.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end10.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ10})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt10.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt10.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ10}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ11" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ11 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ11}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ11}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ11}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ11}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment11.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ11New}']" attr="d" set="start11.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ11New}']" attr="d" set="end11.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment11.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start11.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end11.time}']"/>
        </t:response>
    </t:test>


<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ11})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt11.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt11.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ11}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ12" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ12 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ12}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ12}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ12}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ12}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment12.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ12New}']" attr="d" set="start12.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ12New}']" attr="d" set="end12.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment12.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start12.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end12.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ12})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt12.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt12.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ12}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ13" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ13 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ13}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ13}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ13}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ13}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment13.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ13New}']" attr="d" set="start13.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ13New}']" attr="d" set="end13.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment13.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start13.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end13.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ13})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt13.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt13.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ13}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ14" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ14 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ14}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ14}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ14}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ14}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment14.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ14New}']" attr="d" set="start14.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ14New}']" attr="d" set="end14.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment14.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start14.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end14.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ14})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt14.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt14.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ14}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ15" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ15 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ15}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ15}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ15}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ15}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment15.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ15New}']" attr="d" set="start15.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ15New}']" attr="d" set="end15.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment15.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start15.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end15.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ15})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt15.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt15.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ15}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ16" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ16 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ16}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ16}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ16}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ16}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment16.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ16New}']" attr="d" set="start16.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ16New}']" attr="d" set="end16.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment16.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start16.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end16.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ16})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt16.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt16.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ16}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ17" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ17 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ17}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ17}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ17}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ17}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment17.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ17New}']" attr="d" set="start17.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ17New}']" attr="d" set="end17.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment17.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start17.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end17.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ17})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt17.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt17.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ17}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ18" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ18 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ18}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ18}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ18}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ18}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment18.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ18New}']" attr="d" set="start18.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ18New}']" attr="d" set="end18.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment18.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start18.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end18.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ18})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt18.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt18.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ18}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ19" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ19 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ19}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ19}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ19}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ19}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment19.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ19New}']" attr="d" set="start19.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ19New}']" attr="d" set="end19.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment19.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start19.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end19.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ19})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt19.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt19.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ19}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ20" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ20 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ20}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ20}"/>  
                        <e d="${ICALTIME(+2h)}" tz="${TZ20}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ20}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment20.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ20New}']" attr="d" set="start20.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ20New}']" attr="d" set="end20.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment20.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start20.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end20.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ20})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt20.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt20.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ20}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ21" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ21 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ21}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ21}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ21}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ21}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment21.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ21New}']" attr="d" set="start21.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ21New}']" attr="d" set="end21.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment21.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start21.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end21.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ21})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt21.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt21.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ21}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ22" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ22 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ22}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ22}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ22}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ22}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment22.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ22New}']" attr="d" set="start22.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ22New}']" attr="d" set="end22.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment22.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start22.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end22.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ22})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt22.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt22.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ22}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ23" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ23 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ23}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ23}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ23}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ23}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment23.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ23New}']" attr="d" set="start23.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ23New}']" attr="d" set="end23.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment23.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start23.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end23.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ23})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt23.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt23.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ23}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ24" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ24 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ24}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ24}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ24}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ24}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment24.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ24New}']" attr="d" set="start24.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ24New}']" attr="d" set="end24.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment24.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start24.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end24.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ24})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt24.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt24.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ24}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ25" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ25 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ25}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ25}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ25}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ25}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment25.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ25New}']" attr="d" set="start25.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ25New}']" attr="d" set="end25.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment25.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start25.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end25.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ25})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt25.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt25.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ25}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ26" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ26 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ26}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ26}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ26}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ26}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment26.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ26New}']" attr="d" set="start26.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ26New}']" attr="d" set="end26.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment26.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start26.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end26.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ26})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt26.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt26.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ26}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ27" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ27 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ27}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ27}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ27}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ27}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment27.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ27New}']" attr="d" set="start27.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ27New}']" attr="d" set="end27.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment27.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start27.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end27.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:"(${appointment.subject}.${TZ27})"</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt27.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt27.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ27}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ28" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ28 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ28}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ28}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ28}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ28}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment28.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ28New}']" attr="d" set="start28.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ28New}']" attr="d" set="end28.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment28.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start28.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end28.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ28})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt28.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt28.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ28}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ29" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ29 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ29}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ29}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ29}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ29}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment29.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ29New}']" attr="d" set="start29.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ29New}']" attr="d" set="end29.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment29.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start29.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end29.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ29})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt29.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt29.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ29}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ30" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ30 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ30}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ30}"/>  
                        <e d="${ICALTIME(+3h)}" tz="${TZ30}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ30}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment30.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ30New}']" attr="d" set="start30.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ30New}']" attr="d" set="end30.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment30.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start30.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end30.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ30})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt30.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt30.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ30}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ31" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ31 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ31}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ31}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ31}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ31}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment31.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ31New}']" attr="d" set="start31.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ31New}']" attr="d" set="end31.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment31.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start31.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end31.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ31})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt31.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt31.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ31}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ32" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ32 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ32}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ32}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ32}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ32}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment32.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ32New}']" attr="d" set="start32.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ32New}']" attr="d" set="end32.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment32.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start32.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end32.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ32})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt32.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt32.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ32}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ33" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ33 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ33}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ33}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ33}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ33}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment33.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ33New}']" attr="d" set="start33.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ33New}']" attr="d" set="end33.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment33.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start33.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end33.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ33})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt33.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt33.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ33}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ34" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ34 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ34}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ34}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ34}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ34}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment34.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ34New}']" attr="d" set="start34.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ34New}']" attr="d" set="end34.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment34.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start34.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end34.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ34})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt34.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt34.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ34}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ35" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ35 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ35}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ35}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ35}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ35}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment35.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ35New}']" attr="d" set="start35.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ35New}']" attr="d" set="end35.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment35.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start35.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end35.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ35})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt35.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt35.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ35}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ36" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ36 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ36}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ36}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ36}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ36}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment36.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ36New}']" attr="d" set="start36.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ36New}']" attr="d" set="end36.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment36.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start36.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end36.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ36})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt36.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt36.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ36}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ37" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ37 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ37}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ37}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ37}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ37}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment37.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ37New}']" attr="d" set="start37.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ37New}']" attr="d" set="end37.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment37.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start37.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end37.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ37})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt37.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt37.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ37}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ38" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ38 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ38}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ38}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ38}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ38}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment38.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ38New}']" attr="d" set="start38.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ38New}']" attr="d" set="end38.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment38.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start38.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end38.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ38})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt38.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt38.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ38}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ39" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ39 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ39}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ39}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ39}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ39}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment39.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ39New}']" attr="d" set="start39.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ39New}']" attr="d" set="end39.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment39.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start39.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end39.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ39})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt39.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt39.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ39}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ40" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ40 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ40}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ40}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ40}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ40}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment40.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ40New}']" attr="d" set="start40.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ40New}']" attr="d" set="end40.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment40.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start40.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end40.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ40})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt40.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt40.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ40}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ41" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ41 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ41}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ41}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ41}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ41}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment41.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ41New}']" attr="d" set="start41.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ41New}']" attr="d" set="end41.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment41.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start41.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end41.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ41})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt41.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt41.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ41}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ42" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ42 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ42}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ42}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ42}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ42}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment42.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ42New}']" attr="d" set="start42.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ42New}']" attr="d" set="end42.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment42.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start42.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end42.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ42})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt42.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt42.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ42}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ43" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ43 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ43}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ43}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ43}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ43}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment43.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ43New}']" attr="d" set="start43.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ43New}']" attr="d" set="end43.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment43.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start43.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end43.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ43})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt43.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt43.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ43}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ44" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ44 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ44}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ44}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ44}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ44}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment44.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ44New}']" attr="d" set="start44.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ44New}']" attr="d" set="end44.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment44.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start44.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end44.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ44})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt44.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt44.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ44}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ45" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ45 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ45}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ45}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ45}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ45}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment45.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ45New}']" attr="d" set="start45.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ45New}']" attr="d" set="end45.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment45.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start45.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end45.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ45})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt45.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt45.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ45}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ46" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ46 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ46}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ46}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ46}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ46}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment46.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ46New}']" attr="d" set="start46.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ46New}']" attr="d" set="end46.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment46.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start46.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end46.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ46})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt46.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt46.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ46}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ47" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ47 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ47}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ47}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ47}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ47}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment47.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ47New}']" attr="d" set="start47.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ47New}']" attr="d" set="end47.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment47.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start47.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end47.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ47})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt47.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt47.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ47}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ48Tashkent" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ48Tashkent included.</t:objective>
    
	<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ48Tashkent}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ48Tashkent}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ48Tashkent}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ48Tashkent}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment48.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ48Tashkent}']" attr="d" set="start48.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ48Tashkent}']" attr="d" set="end48.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment48.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start48.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end48.time}']"/>
        </t:response>
    </t:test>

	<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ48Tashkent})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt48.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt48.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ48Tashkent}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>

<t:test_case testcaseid="CreateAppt_TZ48Karachi" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ48Karachi included.</t:objective>
    
	<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ48Karachi}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ48Karachi}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ48Karachi}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ48Karachi}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment48.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ48Karachi}']" attr="d" set="start48.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ48Karachi}']" attr="d" set="end48.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment48.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start48.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end48.time}']"/>
        </t:response>
    </t:test>

	<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ48Karachi})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt48.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt48.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ48Karachi}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ49" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ49 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ49}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ49}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ49}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ49}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment49.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ49New}']" attr="d" set="start49.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ49New}']" attr="d" set="end49.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment49.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start49.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end49.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ49})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt49.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt49.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ49}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ50" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ50 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ50}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+2h)}" tz="${TZ50}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ50}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ50}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment50.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ50New}']" attr="d" set="start50.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ50New}']" attr="d" set="end50.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment50.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start50.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end50.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ50})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt50.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt50.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ50}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ51" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ51 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ51}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ51}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ51}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ51}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment51.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ51New}']" attr="d" set="start51.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ51New}']" attr="d" set="end51.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment51.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start51.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end51.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ51})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt51.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt51.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ51}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ52" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ52 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ52}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ52}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ52}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ52}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment52.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ52New}']" attr="d" set="start52.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ52New}']" attr="d" set="end52.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment52.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start52.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end52.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ52})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt52.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt52.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ52}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ53" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ53 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ53}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ53}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ53}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ53}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment53.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ53New}']" attr="d" set="start53.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ53New}']" attr="d" set="end53.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment53.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start53.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end53.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ53})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt53.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt53.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ53}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ54" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ54 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ54}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ54}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ54}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ54}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment54.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ54New}']" attr="d" set="start54.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ54New}']" attr="d" set="end54.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment54.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start54.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end54.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ54})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt54.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt54.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ54}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ55" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ55 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ55}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ55}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ55}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ55}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment55.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ55New}']" attr="d" set="start55.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ55New}']" attr="d" set="end55.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment55.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start55.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end55.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ55})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt55.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt55.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ55}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ56" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ56 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ56}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ56}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ56}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ56}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment56.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ56New}']" attr="d" set="start56.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ56New}']" attr="d" set="end56.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment56.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start56.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end56.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ56})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt56.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt56.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ56}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ57" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ57 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ57}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ57}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ57}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ57}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment57.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ57New}']" attr="d" set="start57.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ57New}']" attr="d" set="end57.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment57.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start57.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end57.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ57})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt57.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt57.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ57}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ58" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ58 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ58}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ58}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ58}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ58}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment58.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ58New}']" attr="d" set="start58.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ58New}']" attr="d" set="end58.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment58.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start58.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end58.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ58})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt58.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt58.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ58}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ59" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ59 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ59}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ59}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ59}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ59}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment59.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ59New}']" attr="d" set="start59.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ59New}']" attr="d" set="end59.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment59.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start59.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end59.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ59})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt59.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt59.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ59}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ60" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ60 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ60}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ60}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ60}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ60}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment60.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ60New}']" attr="d" set="start60.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ60New}']" attr="d" set="end60.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment60.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start60.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end60.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ60})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt60.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt60.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ60}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ61" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ61 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ61}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ61}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ61}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ61}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment61.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ61New}']" attr="d" set="start61.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ61New}']" attr="d" set="end61.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment61.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start61.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end61.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ61})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt61.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt61.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ61}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ62" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ62 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ62}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ62}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ62}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ62}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment62.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ62New}']" attr="d" set="start62.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ62New}']" attr="d" set="end62.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment62.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start62.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end62.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ62})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt62.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt62.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ62}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ63" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ63 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ63}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ63}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ63}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ63}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment63.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ63New}']" attr="d" set="start63.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ63New}']" attr="d" set="end63.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment63.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start63.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end63.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ63})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt63.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt63.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ63}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ64" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ64 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ64}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ64}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ64}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ64}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment64.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ64New}']" attr="d" set="start64.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ64New}']" attr="d" set="end64.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment64.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start64.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end64.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ64})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt64.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt64.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ64}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ65" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ65 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ65}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ65}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ65}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ65}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment65.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ65New}']" attr="d" set="start65.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ65New}']" attr="d" set="end65.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment65.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start65.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end65.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ65})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt65.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt65.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ65}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ66" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ66 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ66}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ66}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ66}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ66}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment66.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ66New}']" attr="d" set="start66.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ66New}']" attr="d" set="end66.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment66.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start66.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end66.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ66})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt66.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt66.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ66}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ67" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ67 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ67}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ67}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ67}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ67}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment67.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ67New}']" attr="d" set="start67.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ67New}']" attr="d" set="end67.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment67.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start67.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end67.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ67})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt67.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt67.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ67}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ68" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ68 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ68}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ68}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ68}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ68}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment68.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ68New}']" attr="d" set="start68.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ68New}']" attr="d" set="end68.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment68.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start68.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end68.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ68})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt68.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt68.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ68}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ69" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ69 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ69}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ69}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ69}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ69}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment69.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ69New}']" attr="d" set="start69.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ69New}']" attr="d" set="end69.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment69.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start69.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end69.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ69})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt69.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt69.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ69}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ70" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ70 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ70}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+3h)}" tz="${TZ70}"/>  
                        <e d="${ICALTIME(+8h)}" tz="${TZ70}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ70}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment70.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ70New}']" attr="d" set="start70.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ70New}']" attr="d" set="end70.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment70.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start70.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end70.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ70})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt70.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt70.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ70}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ71" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ71 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ71}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ71}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ71}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ71}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment71.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ71New}']" attr="d" set="start71.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ71New}']" attr="d" set="end71.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment71.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start71.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end71.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ71})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt71.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt71.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ71}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ72" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ72 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ72}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ72}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ72}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ72}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment72.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ72New}']" attr="d" set="start72.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ72New}']" attr="d" set="end72.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment72.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start72.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end72.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ72})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt72.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt72.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ72}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ73" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ73 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ73}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ73}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ73}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ73}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment73.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ73New}']" attr="d" set="start73.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ73New}']" attr="d" set="end73.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment73.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start73.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end73.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ73})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt73.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt73.id}" compNum="0" verb="${calendar.verb3}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb3}</su>
			<mp ct="text/plain">
		       	<content>I might attend. Subject: ${appointment.subject}.${TZ73}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ74" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ74 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ74}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ74}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ74}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ74}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment74.id"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz='${TZ74New}']" attr="d" set="start74.time"/>
                     <t:header path = "//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz='${TZ74New}']" attr="d" set="end74.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment74.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start74.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end74.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ74})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt74.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt74.id}" compNum="0" verb="${calendar.verb1}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb1}</su>
			<mp ct="text/plain">
		       	<content>Yes, I will attend. Subject: ${appointment.subject}.${TZ74}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


<t:test_case testcaseid="CreateAppt_TZ75" type="sanity" areas="Calendar">
    <t:objective>Create an appointment with valid values and time zone TZ75 included.</t:objective>
    
<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:property name="authToken" value="${test1.authToken}"/>  


    <t:test>
        <t:request>
            <CreateAppointmentRequest xmlns="urn:zimbraMail">
                <m>
                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}.${TZ75}" loc="${appointment.location}">
                        <at role="OPT" ptst="NE" rsvp="1" a="${invitee_account1.name}"/>
                        <s d="${ICALTIME(+1h)}" tz="${TZ75}"/>  
                        <e d="${ICALTIME(+4h)}" tz="${TZ75}"/>
                        <or a="${test_account1.name}"/>
                    </inv>
                    <e a="${invitee_account1.name}" t="t"/>
                    <mp content-type="text/plain">
                        <content>${appointment.content}</content>
                    </mp>
                    <su>${appointment.subject}.${TZ75}</su>
                </m>
            </CreateAppointmentRequest>
        </t:request>
        <t:response>
			<t:select path = "//mail:CreateAppointmentResponse" attr="invId" set="appointment75.id"/>
                     <t:header path = '//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:s[@tz="${TZ75New}"]' attr="d" set="start75.time"/>
                     <t:header path = '//zimbra:context/zimbra:notify/zimbra:created/zimbra:appt/zimbra:inv/zimbra:comp/zimbra:e[@tz="${TZ75New}"]' attr="d" set="end75.time"/>
        </t:response>
    </t:test>

    <t:test>
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment75.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:s[@d='${start75.time}']"/>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:comp/mail:e[@d='${end75.time}']"/>
        </t:response>
    </t:test>

<t:property name="server.zimbraAccount" value="${invitee_acct.server}"/>

    <t:property name="authToken" value="${invitee1.authToken}"/>  


    <t:test>
        <t:request>
	     <SearchRequest xmlns="urn:zimbraMail" offset="0" limit="25" types="conversation,contact,appointment">
                <query>subject:(${appointment.subject}.${TZ75})</query>
            </SearchRequest>
        </t:request>
        <t:response>
            <t:select path="//mail:SearchResponse/mail:c/mail:m" attr="id" set="appt75.id"/>
        </t:response>
    </t:test>
    
    <t:test>
        <t:request>
            <SendInviteReplyRequest xmlns="urn:zimbraMail" id="${appt75.id}" compNum="0" verb="${calendar.verb2}" updateOrganizer="TRUE">
                <m rt="r">
			<e t="t" a="${test_account1.name}"/>
			<su>${calendar.verb2}</su>
			<mp ct="text/plain">
		       	<content>No, I won't attend. Subject: ${appointment.subject}.${TZ75}Organizer:  Time: Sunday, March 6, 2005, 10:30:00 AM - 11:30:00 AM Invitees:  *~*~*~*~*~*~*~*~*~* </content>
			</mp>
		  </m>
            </SendInviteReplyRequest>
	 </t:request>
        <t:response>
	     <t:select path="//mail:SendInviteReplyResponse"/>
	 </t:response>
    </t:test>

</t:test_case>


</t:tests>
