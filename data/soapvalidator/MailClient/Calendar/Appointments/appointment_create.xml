<t:tests xmlns:t="urn:zimbraTestHarness">

<t:property name="server.zimbraAdmin" value="${zimbraServer.name}"/>


<t:property name="test_account1.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>

<t:property name="test_account2.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>

<t:property name="test_account3.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>

<t:property name="test_account4.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>

<t:property name="test_account5.name" value="test${TIME}.${COUNTER}@@${defaultdomain.name}"/>

<t:property name="test_account6.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>


<t:property name="test_account1.password" value="test123"/>

<t:property name="test_account2.password" value="test123"/>

<t:property name="test_account4.password" value="test123"/>

<t:property name="test_account6.password" value="test123"/>


<t:property name="appointment.subject" value="Subject of meeting${TIME}.${COUNTER}"/>

<t:property name="appointment.location" value="Location of meeting${TIME}.${COUNTER}"/>

<t:property name="appointment.content" value="Content of the message${TIME}.${COUNTER}"/>


<t:property name="CurrentTime" value="${GENTIME}"/>

<t:property name="Time1" value="${ICALTIME(+30m)}"/>

<t:property name="Time2" value="${ICALTIME(+1h)}"/>

<t:property name="Time3" value="${ICALTIME(-1h)}"/>

<t:property name="Time4" value="${ICALTIME(-30m)}"/>

<t:property name="Time5" value="${ICALTIME(-1d)}"/>

<t:property name="Time6" value="${ICALTIME(-1d)(+30m)}"/>

<t:property name="Time7" value="${ICALTIME(+30d)}"/>

<t:property name="Time8" value="${ICALTIME(-30d)}"/>

<t:property name="Time9" value="${ICALTIME(+180d)}"/>

<t:property name="Time10" value="${ICALTIME(+1080d)}"/>

<t:property name="Time11" value="${CURRDATE}"/>

<t:property name="Time12" value="${ICALTIME}"/>

<t:property name="Date1" value="15"/>

<t:property name="test_acct.server" value="NOT_DEFINED"/>


<t:test_case testcaseid="Ping" type="always" >

    <t:objective>basic system check</t:objective>

    

    <t:test id="ping">

        <t:request>

            <PingRequest xmlns="urn:zimbraAdmin"/>

        </t:request>

        <t:response>

            <t:select path="//admin:PingResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid="acct_setup" type="always" >

    <t:objective>Create test accounts</t:objective>

   

    <!-- Login to admin -->

    <t:test id="admin_login" required="true" depends="ping">

        <t:request>

            <AuthRequest xmlns="urn:zimbraAdmin">

                <name>${admin.user}</name>

                <password>${admin.password}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:AuthResponse/admin:authToken" set="authToken"/>

        </t:response>

    </t:test>

    

    <t:test id="create_test_account1" required="false" depends="admin_login">

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${test_account1.name}</name>

                <password>${test_account1.password}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="test_account1.id"/>

            <t:select path='//admin:CreateAccountResponse/admin:account/admin:a[@n="zimbraMailHost"]' set="test_acct.server"/>

        </t:response>

    </t:test>


    <t:test id="create_test_account2" required="false" depends="admin_login">

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${test_account2.name}</name>

                <password>${test_account2.password}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="test_account2.id"/>

        </t:response>

    </t:test>


    <t:test id="create_test_account4" required="false" depends="admin_login">

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${test_account4.name}</name>

                <password>${test_account4.password}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="test_account4.id"/>

        </t:response>

    </t:test>


    <t:test id="create_test_account6" required="false" depends="admin_login">

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${test_account6.name}</name>

                <password>${test_account6.password}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="test_account6.id"/>

        </t:response>

    </t:test>


</t:test_case>


<t:property name="server.zimbraAccount" value="${test_acct.server}"/>


<t:test_case testcaseid="acct_setup2" type="always" >

    <t:objective>login as the test account</t:objective>

    

    <t:test id="auth1" required="true">

        <t:request>

            <AuthRequest xmlns="urn:zimbraAccount">

                <account by="name">${test_account1.name}</account>

                <password>${test_account1.password}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>



        </t:response>

    </t:test>

    

</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest3" type = "negative" areas="Calendar">

    <t:objective>Create an appointment starting with 1 hour before the current time and ending half hour before the current time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time3}"/>  

                        <e d="${Time4}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest5" type = "negative" areas="Calendar">

    <t:objective>Create an appointment starting and ending yesterday. </t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time5}"/>  

                        <e d="${Time6}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest6" type = "negative" bugids="2550" areas="Calendar">

    <t:objective>Create an appointment with non-existing account name in attendees</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account3.name}"/>

                        <s d="${Time3}"/>  

                        <e d="${Time4}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account3.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <!-- <t:select path="//mail:CreateAppointmentResponse/mail:m"/> -->
            <t:select path = "//mail:CreateAppointmentResponse"/>
            

        </t:response>

    </t:test>

	<t:delay msec="8000"/>
	
	<t:test>

        <t:request>

			<SearchRequest xmlns="urn:zimbraMail">

				<query>in:inbox</query>

			</SearchRequest>

		</t:request>

		<t:response>

			<t:select path="//mail:SearchResponse"/>

		</t:response>

	</t:test>

	<t:test id="CreateAppointmentRequest6a" depends="CreateAppointmentRequest6">

        <t:request>

			<SearchRequest xmlns="urn:zimbraMail">

				<query>in:inbox</query>

			</SearchRequest>

		</t:request>

		<t:response>

			<t:select path="//mail:SearchResponse/mail:c" attr="su" match="^Undelivered Mail Returned to Sender"/>

		</t:response>

	</t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest7" type = "negative" bugids="2551" areas="Calendar">

    <t:objective>Create an appointment which starts and end at the same time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time1}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest8" type = "negative" bugids="2551" areas="Calendar">

    <t:objective>Create an appointment which ends before the start time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time2}"/>  

                        <e d="${Time5}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest10" type = "negative" areas="Calendar" bugids="4255">

    <t:objective>Create an appointment with start and end time as alphabets </t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="aaaa"/>  

                        <e d="bbbb"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path="//zimbra:Code" match="^service.INVALID_REQUEST"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest11" type = "smoke" areas="Calendar">

    <t:objective>Create an appointment inviting multiple people.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account4.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <e a="${test_account4.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest12" type = "functional" bugids="2550" areas="Calendar">

    <t:objective>Create an appointment inviting multiple people in which address of one attendee is invalid .</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account5.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <e a="${test_account5.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path="//mail:CreateAppointmentResponse" attr="invId" set="appointment12.id" />

        </t:response>

    </t:test>
    
    <t:test depends="GetAppointmentRequest1a">
        <t:request> 
            <GetAppointmentRequest  xmlns="urn:zimbraMail" id="${appointment12.id}"/>
        </t:request>
        <t:response>
            <t:select path = "//mail:GetAppointmentResponse/mail:appt/mail:inv/mail:at" attr="a" match="${test_account5.name}" emptyset="1"/>
           
        </t:response>
    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest14" type = "negative" bugids="2550" areas="Calendar" >

    <t:objective>Create an appointment having attendee whose account has been deleted.</t:objective>

    <t:steps>1.Login to admin.

            2.delete an account.

            3.Login to mail client.

            4.Create an appointment with attendee whose account has been deleted.        

    </t:steps>


<t:property name="server.zimbraAdmin" value="${zimbraServer.name}"/>


    <!-- login to admin-->

    <t:test>

        <t:request>

            <AuthRequest xmlns="urn:zimbraAdmin">

                <name>${admin.user}</name>

                <password>${admin.password}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:AuthResponse/admin:authToken" set="authToken"/>

        </t:response>

    </t:test>

    

    <!-- delete an account.-->   

    <t:test>

        <t:request>

            <DeleteAccountRequest xmlns = "urn:zimbraAdmin">

                <id>${test_account6.id}</id>                

            </DeleteAccountRequest>

        </t:request>

        <t:response>

            <t:select path = "//admin:DeleteAccountResponse"/>

        </t:response>

    </t:test>

  

<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <!-- login to mail client -->

    <t:test>

        <t:request>

            <AuthRequest xmlns="urn:zimbraAccount">

                <account by="name">${test_account1.name}</account>

                <password>${test_account1.password}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>



        </t:response>

    </t:test>   


    <!--Create an appointment with attendee whose account has been deleted.-->

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account6.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account6.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>
 
            <!-- <t:select path="//mail:CreateAppointmentResponse/mail:m"/> -->
            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>

	<t:delay msec="8000"/>
	
	<t:test>

        <t:request>

			<SearchRequest xmlns="urn:zimbraMail">

				<query>in:inbox</query>

			</SearchRequest>

		</t:request>

		<t:response>

			<t:select path="//mail:SearchResponse"/>

		</t:response>

	</t:test>
	

	<t:test>

        <t:request>

			<SearchRequest xmlns="urn:zimbraMail">

				<query>in:inbox</query>

			</SearchRequest>

		</t:request>

		<t:response>

			<t:select path="//mail:SearchResponse/mail:c" attr="su" match="^Undelivered Mail Returned to Sender"/>

		</t:response>

	</t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest15" type = "smoke" areas="calendar">

    <t:objective>create a daily appointment never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time1}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest16" type = "smoke" areas="calendar">

    <t:objective>create a daily appointment ending in one month(30 days)</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1">

 					<until d="${Time7}"/>

                                </rule>


                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest17" type = "functional" areas="calendar">

    <t:objective>create a daily appointment ending on the same day.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1">

 					<until d="${Time11}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest18" type = "smoke" areas="calendar">

    <t:objective>create a daily appointment for(ending after) 2 times</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest19" type = "smoke" areas="calendar">

    <t:objective>create a daily appointment every 2 day never ending.</t:objective>

    

    <t:test>

        <t:request>

               <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest20" type = "smoke" areas="calendar">

    <t:objective>create a daily appointment every 2 days ending in one month(30 days) </t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="2">

					 <until d="${Time7}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest22" type = "smoke" areas="calendar">

    <t:objective>create a weekly appointment never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest23" type = "smoke" areas="calendar">

    <t:objective>create a weekly appointment ending in one month(30 days)</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1">

					 <until d="${Time7}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest24" type = "functional" areas="calendar">

    <t:objective>create a weekly appointment ending on the same day.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1">

                                <until d="${Time11}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest25" type = "smoke" areas="calendar">

    <t:objective>create a weekly appointment for(ending after) 2 times</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1" count="2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest26" type = "smoke" areas="calendar">

    <t:objective>create a weekly appointment every 2 weeks never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="2">

                                    <byday>

                                        <wkday day="WE"/>

                                        <wkday day="TH"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest29" type = "smoke" areas="calendar">

    <t:objective>create a monthly appointment never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                            <s d="${Time1}"/>  

                            <e d="${Time2}"/>  

                            <or a="${test_account1.name}"/>

                            <recur>

                                <add>

                                    <rule freq="MON" ival="1"/>

                                </add>

                            </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest30" type = "smoke" areas="calendar">

    <t:objective>create a monthly appointment ending in one month(30 days)</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1">

                                <until d="${Time7}"/>

                                </rule>

                            </add>

                        </recur>

                        </inv>

                        <e a="${test_account2.name}" t="t"/>

                        <mp content-type="text/plain">

                            <content>${appointment.content}</content>

                        </mp>

                        <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest31" type = "functional" areas="calendar">

    <t:objective>create a monthly appointment ending on the same day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1">

                                <until d="${CURRDATE}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest32" type = "smoke" areas="calendar">

<t:objective>create a monthly appointment for(ending after) 2 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1" count="2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest33" type = "functional" areas="calendar">

    <t:objective>create a monthly appointment every 2 months on 1,2 and 3rd date of month never ending </t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="2">

                                    <bymonthday modaylist="1,2,3"/>

                                    <x-name name="repeatCustomType" value="S"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest34" type = "smoke" areas="calendar">

    <t:objective>create a monthly appointment every 2 months  on 1,2 and 3rd date of month ending in 6 month(180 days).</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="2">

                                 <until d="${Time9}"/>

              

                                    <bymonthday modaylist="1,2,3"/>

                                    <x-name name="repeatCustomType" value="S"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest36" type = "functional" areas="calendar">

    <t:objective>create a monthly appointment every 2 months on second monday of month never ending  </t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="2">

                                    <byday>

                                        <wkday ordwk="2" day="MO"/>

                                    </byday>

                                    <x-name name="repeatCustomType" value="O"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest37" type = "smoke" areas="calendar">

    <t:objective>create a monthly appointment every 2 months on second monday of month ending in 6 month(180 days) .</t:objective>


    <t:test>

            <t:request>

                <CreateAppointmentRequest xmlns="urn:zimbraMail">

                    <m>

                        <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                            <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                            <s d="${Time1}"/>  

                            <e d="${Time2}"/>  

                            <or a="${test_account1.name}"/>

                            <recur>

                                <add>

                                    <rule freq="MON" ival="2">

                                    <until d="${Time9}"/>

                                        <byday>

                                            <wkday ordwk="2" day="MO"/>

                                        </byday>

                                        <x-name name="repeatCustomType" value="O"/>

                                    </rule>

                                </add>

                            </recur>

                        </inv>

                        <e a="${test_account2.name}" t="t"/>

                        <mp content-type="text/plain">

                            <content>${appointment.content}</content>

                        </mp>

                        <su>${appointment.subject}</su>

                    </m>

                </CreateAppointmentRequest>

            </t:request>

            <t:response>

                <t:select path = "//mail:CreateAppointmentResponse"/>

            </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest40" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment ending in one month(30 days)</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time7}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest41" type = "functional" areas="calendar">

    <t:objective>create a yearly appointment ending on the same day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time11}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest42" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment for(ending after) 1 time</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1" count="1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest43" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment on a date of May </t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <bymonth molist="4"/>

                                    <x-name name="repeatCustomType" value="S"/>

                                    <bymonthday modaylist="${Date1}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest44" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment on a date of May ending in 3 years(1080 days)</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time10}"/>

                                    <bymonth molist="4"/>

                                    <x-name name="repeatCustomType" value="S"/>

                                    <bymonthday modaylist="${Date1}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest46" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment on the last monday of april never ending.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <s d="${Time1}"/>

                        <e d="${Time2}"/>

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <bymonth molist="3"/>

                                    <x-name name="repeatCustomType" value="O"/>

                                    <byday>

                                        <wkday ordwk="-1" day="MO"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>    

                    </inv>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest47" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment on the last monday of april ending in one month(30 days)</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time7}"/>

                                    <bymonth molist="3"/>

                                    <x-name name="repeatCustomType" value="O"/>

                                    <byday>

                                        <wkday ordwk="-1" day="MO"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest49" type = "smoke" areas="calendar">

    <t:objective>create a yearly appointment on the last monday of april for(ending after) 1 time</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1" count="1">

                                    <bymonth molist="3"/>

                                    <x-name name="repeatCustomType" value="O"/>

                                    <byday>

                                        <wkday ordwk="-1" day="MO"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest50" type = "smoke" areas="calendar" bugids="4106">

    <t:objective>create an all day appointment </t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" status="CONF"  allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                    </inv>

                    <!-- Matt: is this a typo? 

                    <e a="${test_account2.name}" t="t"/>

                     -->

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest51" type = "smoke" areas="calendar" bugids="4106">

    <t:objective>create a all day daily appointment ending in one month(30 days)</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1">

                                    <until d="${Time7}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest52" type = "functional" areas="calendar"   bugids="4106">

    <t:objective>create a all day daily appointment ending on the same day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" >

                                    <until d="${Time11}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest53" type = "smoke" areas="calendar" bugids="4106">

    <t:objective>create a all day daily appointment for(ending after) 1 time</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>





<t:test_case testcaseid = "CreateAppointmentRequest54" type = "functional" areas="calendar"   bugids="4106">

    <t:objective>create a all day daily appointment every 2 day never ending.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O"   allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest57" type = "negative" areas="calendar">

    <t:objective>create a daily appointment ending one month(30 days) before the current day</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1">

                                    <until d="${Time8}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest58" type = "negative" areas="calendar">

    <t:objective>create a daily appointment for(ending after) -1 times</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="-1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest59" type = "negative" areas="calendar">

    <t:objective>create a daily appointment for(ending after) 0 times</t:objective> 

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="0"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest60" type = "negative" areas="calendar">

    <t:objective>create a daily appointment every -2 days never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="-2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest61" type = "negative" areas="calendar">

    <t:objective>create a daily appointment every 0 days never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="0"/>

                            </add>

                        </recur>

                        </inv>

                        <e a="${test_account2.name}" t="t"/>

                        <mp content-type="text/plain">

                            <content>${appointment.content}</content>

                        </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest62" type = "negative" areas="calendar">

    <t:objective>create a weekly appointment ending one month(30 days) before the current day</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1">

                                    <until d="${Time8}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest63" type = "negative" areas="calendar">

    <t:objective>create a weekly appointment for(ending after) -1 times</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1" count="-1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest64" type = "negative" areas="calendar">

    <t:objective>create a weekly appointment for(ending after) 0 times</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="1" count="0"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest65" type = "negative" areas="calendar">

    <t:objective>create a weekly appointment every -2 weeks never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="-2">

                                    <byday>

                                        <wkday day="WE"/>

                                        <wkday day="TH"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest66" type = "negative" areas="calendar">

    <t:objective>create a weekly appointment every 0 weeks never ending.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="WEE" ival="0">

                                    <byday>

                                        <wkday day="WE"/>

                                        <wkday day="TH"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest67" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment ending one month(30 days) before the current day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1">

                                    <until d="${Time8}"/>

                                </rule>


                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                    </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest68" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment for(ending after) -1 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1" count="-1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                    <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest69" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment for(ending after) 0 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="1" count="0"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                        <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>


<t:test_case testcaseid = "CreateAppointmentRequest71" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment every 0 months  on 1,2 and 3rd date of month never ending.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="0">

                                    <bymonthday modaylist="1,2,3"/>

                                    <x-name name="repeatCustomType" value="S"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest72" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment every -2 months on second monday of month never ending .</t:objective>


        <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="-2">

                                    <byday>

                                        <wkday ordwk="2" day="MO"/>

                                    </byday>

                                    <x-name name="repeatCustomType" value="O"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

        </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest73" type = "negative" areas="calendar">

    <t:objective>create a monthly appointment every 0 months on second monday of month never ending  .</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="MON" ival="0">

                                    <byday>

                                        <wkday ordwk="2" day="MO"/>

                                    </byday>

                                    <x-name name="repeatCustomType" value="O"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest74" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment ending in one month(30 days) before the current day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time8}"/>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest75" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment for(ending after) -1 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1" count="-1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest76" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment for(ending after) 0 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1" count="0"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest77" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment on the last monday of april ending in one month(30 days) before the current day.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1">

                                    <until d="${Time8}"/>

                                    <bymonth molist="3"/>

                                    <x-name name="repeatCustomType" value="O"/>

                                    <byday>

                                        <wkday ordwk="-1" day="MO"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest78" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment  on the last monday of april for(ending after) -1 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                    <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                    <s d="${Time1}"/>  

                    <e d="${Time2}"/>  

                    <or a="${test_account1.name}"/>

                    <recur>

                        <add>

                            <rule freq="YEA" ival="1" count="-1">

                                <bymonth molist="3"/>

                                <x-name name="repeatCustomType" value="O"/>

                                <byday>

                                    <wkday ordwk="-1" day="MO"/>

                                </byday>

                            </rule>

                        </add>

                    </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest79" type = "negative" areas="calendar">

    <t:objective>create a yearly appointment on the last monday of april for(ending after) 0 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}"/>  

                        <e d="${Time2}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="YEA" ival="1" count="0">

                                    <bymonth molist="3"/>

                                    <x-name name="repeatCustomType" value="O"/>

                                    <byday>

                                        <wkday ordwk="-1" day="MO"/>

                                    </byday>

                                </rule>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest80" type = "negative" areas="calendar">

    <t:objective>create a all day daily appointment ending in one month(30 days) before the current day</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1">

                                    <until d="${Time8}"/>

                                </rule>


                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest81" type = "negative" areas="calendar">

    <t:objective>create a all day daily appointment for(ending after) -1 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="-1"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest82" type = "negative" areas="calendar">

    <t:objective>create a all day daily appointment for(ending after) 0 times</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="1" count="0"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest83" type = "negative" areas="calendar">

    <t:objective>create a all day daily appointment every -2 days never ending.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                        <recur>

                            <add>

                                <rule freq="DAI" ival="-2"/>

                            </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest84" type = "negative" areas="calendar">

    <t:objective>create a all day daily appointment every 0 days never ending.</t:objective>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="1" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst  ="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time11}"/>  

                        <e d="${Time11}"/>  

                        <or a="${test_account1.name}"/>

                            <recur>

                                <add>

                                    <rule freq="DAI" ival="0"/>

                                </add>

                        </recur>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest85" type = "smoke" areas="Calendar">

    <t:objective>Create an appointment with valid values and time zone included.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}" tz="(GMT-10.00) Hawaii"/>  

                        <e d="${Time2}" tz="(GMT-10.00) Hawaii"/>

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest86" type = "smoke" areas="Calendar">

    <t:objective>Create an appointment with invalid time zone in start time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}" tz="(GMT-08.00) abc / def"/>

                        <e d="${Time2}" tz="(GMT-10.00) Hawaii"/>

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path="//zimbra:Code" match="^service.INVALID_REQUEST"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest87" type = "smoke" areas="Calendar">

    <t:objective>Create an appointment with invalid time zone in end time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}" tz="(GMT-10.00) Hawaii"/>

                        <e d="${Time2}" tz="(GMT-08.00) abc / def"/>

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path="//zimbra:Code" match="^service.INVALID_REQUEST"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid = "CreateAppointmentRequest88" type = "smoke" areas="Calendar">

    <t:objective>Create an appointment with invalid time zone in start and end time.</t:objective>

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="${appointment.subject}" loc="${appointment.location}">

                        <at role="OPT" ptst="NE" rsvp="1" a="${test_account2.name}"/>

                        <s d="${Time1}" tz="some text"/>

                        <e d="${Time2}" tz="some text"/>

                        <or a="${test_account1.name}"/>

                    </inv>

                    <e a="${test_account2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>${appointment.content}</content>

                    </mp>

                    <su>${appointment.subject}</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path="//zimbra:Code" match="^service.INVALID_REQUEST"/>

        </t:response>

    </t:test>


</t:test_case>




<t:test_case testcaseid="appointment_create4258A" type="functional" bugids="4258">

    <t:objective>create a lot of appointments in an account to test 4258</t:objective>

   

	<t:property name="4258acct1.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>

	<t:property name="4258acct2.name" value="test${TIME}.${COUNTER}@${defaultdomain.name}"/>


<t:property name="server.zimbraAdmin" value="${zimbraServer.name}"/>

    <!-- Login to admin -->

    <t:test >

        <t:request>

            <AuthRequest xmlns="urn:zimbraAdmin">

                <name>${admin.user}</name>

                <password>${admin.password}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:AuthResponse/admin:authToken" set="authToken"/>

        </t:response>

    </t:test>

    

    <t:test >

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${4258acct1.name}</name>

                <password>${defaultpassword.value}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="4258acct1.id"/>

            <t:select path='//admin:CreateAccountResponse/admin:account/admin:a[@n="zimbraMailHost"]' set="test_acct.server"/>

        </t:response>

    </t:test>


    <t:test >

        <t:request>

            <CreateAccountRequest xmlns="urn:zimbraAdmin">

                <name>${4258acct2.name}</name>

                <password>${defaultpassword.value}</password>

            </CreateAccountRequest>

        </t:request>

        <t:response>

            <t:select path="//admin:CreateAccountResponse/admin:account" attr="id"  set="4258acct2.id"/>

        </t:response>

    </t:test>


    

<t:property name="server.zimbraAccount" value="${test_acct.server}"/>

    <t:test >

        <t:request>

            <AuthRequest xmlns="urn:zimbraAccount">

                <account by="name">${4258acct1.name}</account>

                <password>${defaultpassword.value}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>



        </t:response>

    </t:test>

    

    

    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+1h)}"/>  

                        <e d="${ICALTIME(+2h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+3h)}"/>  

                        <e d="${ICALTIME(+4h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+5h)}"/>  

                        <e d="${ICALTIME(+6h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+7h)}"/>  

                        <e d="${ICALTIME(+8h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+9h)}"/>  

                        <e d="${ICALTIME(+10h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+11h)}"/>  

                        <e d="${ICALTIME(+12h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+13h)}"/>  

                        <e d="${ICALTIME(+14h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+15h)}"/>  

                        <e d="${ICALTIME(+16h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+17h)}"/>  

                        <e d="${ICALTIME(+18h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+19h)}"/>  

                        <e d="${ICALTIME(+20h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+21h)}"/>  

                        <e d="${ICALTIME(+22h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+23h)}"/>  

                        <e d="${ICALTIME(+24h)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+1440m)}"/>  

                        <e d="${ICALTIME(+1500m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+2880m)}"/>  

                        <e d="${ICALTIME(+2960m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+4320m)}"/>  

                        <e d="${ICALTIME(+4400m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+5760m)}"/>  

                        <e d="${ICALTIME(+5860m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+7200m)}"/>  

                        <e d="${ICALTIME(+7280m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+8640m)}"/>  

                        <e d="${ICALTIME(+8720m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test>

        <t:request>

            <CreateAppointmentRequest xmlns="urn:zimbraMail">

                <m>

                    <inv method="REQUEST" type="event" fb="B" transp="O" allDay="0" name="appointment">

                        <at role="OPT" ptst="NE" rsvp="1" a="${4258acct2.name}"/>

                        <s d="${ICALTIME(+10080m)}"/>  

                        <e d="${ICALTIME(+10160m)}"/>  

                        <or a="${4258acct1.name}"/>

                    </inv>

                    <e a="${4258acct2.name}" t="t"/>

                    <mp content-type="text/plain">

                        <content>content</content>

                    </mp>

                    <su>appointment</su>

                </m>

            </CreateAppointmentRequest>

        </t:request>

        <t:response>

            <t:select path = "//mail:CreateAppointmentResponse"/>

        </t:response>

    </t:test>


    <t:test id="auth1" required="true">

        <t:request>

            <AuthRequest xmlns="urn:zimbraAccount">

                <account by="name">${4258acct1.name}</account>

                <password>${defaultpassword.value}</password>

            </AuthRequest>

        </t:request>

        <t:response>

            <t:select path="//acct:AuthResponse/acct:authToken" set="authToken"/>



        </t:response>

    </t:test>

    


</t:test_case>




</t:tests>

